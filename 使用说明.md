# 三坐标测量数据更新工具 - 使用说明

## 功能特性

✅ **智能调整测量点数量** - 自动添加或删除测量点  
✅ **保持完整行结构** - 标题、表头、坐标轴标签、公差、公式全部保留  
✅ **自动格式化** - 负数显示为标准格式 `-123.456` 而不是 `(123.456)`  
✅ **支持CSV导入** - 从CSV文件批量导入测量数据  
✅ **命令行支持** - 可通过命令行参数快速执行

## 使用方法

### 方法1：交互式使用

```bash
py 三坐标数据更新工具.py
```

然后按提示输入：
1. Excel文件路径
2. 工作表名称（前模仁/后模仁）
3. 选择数据输入方式（CSV文件）

### 方法2：命令行参数

```bash
py 三坐标数据更新工具.py "Excel文件路径.xlsx" "前模仁"
```

## CSV数据格式

CSV文件应包含以下列：

```csv
测量点,轴,TOL,TOL,NomiNal,Measured,Dev/Mean,Error/OK
no.1,X,-0.03,0.03,123.456,123.465,0.009,OK
,Y,-0.03,0.03,234.567,234.558,-0.009,OK
,Z,-0.03,0.03,345.678,345.685,0.007,OK
no.2,X,-0.03,0.03,-45.678,-45.685,-0.007,OK
...
```

**注意事项：**
- 测量点列格式：`no.1`, `no.2` 等
- 轴列格式：`X`, `Y`, `Z`
- 数值列：`NomiNal`, `Measured` 必须是有效数字
- 文件编码：UTF-8

## 工作原理

1. **读取Excel文件** - 打开指定的三坐标报告Excel文件
2. **分析当前结构** - 统计当前测量点数量
3. **智能调整** - 根据新数据自动添加或删除测量点
4. **更新数据** - 填充NomiNal和Measured值
5. **设置格式** - 应用标准数字格式和公式
6. **保存文件** - 保存更新后的Excel文件

## 示例

### 更新P25-249前模仁

```bash
py 三坐标数据更新工具.py "P25-249-前门扶手本体上（左右）-三坐标报告.xlsx" "前模仁"
```

然后选择CSV文件：
```
请输入CSV文件路径: 测量数据.csv
```

## 技术细节

- **行结构模板** - 使用第19-23行作为模板复制新测量点
- **行号计算** - 测量点N的起始行 = 13 + (N-1) × 6
- **数据位置** - G列(NomiNal), H列(Measured), I列(公式)
- **数字格式** - `0.000` (保留3位小数)
- **公式格式** - `=H行号-G行号`

## 今天处理的文件统计

共处理 **7个文件**，**14个工作表**：
1. P25-249 (前模仁 + 后模仁)
2. P25-259 (前模仁 + 后模仁)
3. P25-257 (前模仁 + 后模仁)
4. P25-258 (前模仁 + 后模仁)
5. P25-260 (前模仁 + 后模仁)
6. P25-261 (前模仁 + 后模仁)
7. P25-262 (前模仁 + 后模仁)

## 注意事项

⚠️ **使用前请确保：**
- Excel文件未被其他程序打开
- CSV数据格式正确
- 已安装 `openpyxl` 库：`py -m pip install openpyxl`

⚠️ **安全提示：**
- 工具会直接修改原Excel文件
- 建议先备份重要文件
- 首次使用建议在测试文件上验证

## 故障排除

**问题：Permission denied**
- 解决：关闭Excel文件后重试

**问题：CSV解析失败**
- 解决：检查CSV文件编码是否为UTF-8
- 解决：检查列名是否完全匹配

**问题：测量点数量不对**
- 解决：检查CSV中测量点编号是否连续
- 解决：确认no.1, no.2格式正确
